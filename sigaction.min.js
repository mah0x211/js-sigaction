/* Copyright (C) 2018 Masatoshi Fukunaga */
(function(){function e(a){(a instanceof HTMLElement||a instanceof SVGElement)&&a._signal_ctx&&(a._signal_ctx.j.forEach(function(b){a.removeEventListener(b,k)}),a._signal_ctx=null)}function k(a){var b=a.target._signal_ctx;b&&f.apply(f,[b.name,a].concat(b.h))}function g(a){if((a instanceof HTMLElement||a instanceof SVGElement)&&a.dataset.sigaction){a._signal_ctx&&e(a);var b=a.dataset.sigaction.split("|"),d=b[0].trim(),c=(b[1]||"").split(",").map(function(a){return a.trim()}),n=(b[2]||"").split(",").map(function(a){return a.trim()});
if(2>b.length||3<b.length)throw new SyntaxError("data-signal format must be signame|event,...|arg,...");c.forEach(function(b){a.addEventListener(b,k)});a._signal_ctx={name:d,j:c,h:n}}}function p(a){a.forEach(function(a){switch(a.type){case "attributes":a=a.target;a.dataset.sigaction?g(a):e(a);break;case "childList":Array.prototype.slice.call(a.addedNodes).forEach(g),Array.prototype.slice.call(a.removedNodes).forEach(e)}})}function l(){window.removeEventListener("load",l);(new MutationObserver(p)).observe(document.body,
{childList:!0,subtree:!0,attributes:!0});Array.prototype.slice.call(document.querySelectorAll("*[data-sigaction]")).forEach(g)}function f(a,b){if("string"!==typeof a)throw new TypeError("signame must be string");var d=h[a];if(d){var c=Array.prototype.slice.call(arguments);c.shift();d.forEach(function(a){try{a.g.apply(a.i,c)}catch(m){console.error(m)}})}}var h={};window.addEventListener("load",l);window.sigaction=function(a,b,d){if("string"!==typeof a)throw new TypeError("signame must be string");
if("function"!==typeof b)throw new TypeError("act must be function");var c=h[a];if(c){a=0;for(var e=c.length;a<e;a++)if(c[a].g===b)return}else c=[],h[a]=c;c.push({g:b,i:d||b})};window.sigraise=f})();
