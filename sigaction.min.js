/* Copyright (C) 2018 Masatoshi Fukunaga */
(function(){function e(a){(a instanceof HTMLElement||a instanceof SVGElement)&&a._signal_ctx&&(a._signal_ctx.l.forEach(function(b){a.removeEventListener(b,l)}),a._signal_ctx=null)}function l(a){var b=a.target._signal_ctx;b&&f.apply(f,[b.name,a].concat(b.i))}function h(a){if((a instanceof HTMLElement||a instanceof SVGElement)&&a.dataset.g){a._signal_ctx&&e(a);var b=a.dataset.g.split("|"),d=b[0].trim(),c=(b[1]||"").split(",").map(function(a){return a.trim()}),q=(b[2]||"").split(",").map(function(a){return a.trim()});
if(2>b.length||3<b.length)throw new SyntaxError("data-signal format must be signame|event,...|arg,...");c.forEach(function(b){a.addEventListener(b,l)});a._signal_ctx={name:d,l:c,i:q}}}function r(a){a.forEach(function(a){switch(a.type){case "attributes":a=a.target;a.dataset.g?h(a):e(a);break;case "childList":Array.prototype.slice.call(a.addedNodes).forEach(h),Array.prototype.slice.call(a.removedNodes).forEach(e)}})}function n(){window.removeEventListener("load",n);(new MutationObserver(r)).observe(document.body,
{childList:!0,subtree:!0,attributes:!0});Array.prototype.slice.call(document.querySelectorAll("*[data-sigaction]")).forEach(h)}function f(a,b){if("string"!==typeof a)throw new TypeError("signame must be string");var d=k[a];if(d){var c=Array.prototype.slice.call(arguments);c.shift();d.forEach(function(a){try{a.h.apply(a.j,c)}catch(p){console.error(p)}})}}var k={};window.addEventListener("load",n);window.g=function(a,b,d){if("string"!==typeof a)throw new TypeError("signame must be string");if("function"!==
typeof b)throw new TypeError("act must be function");var c=k[a];if(c){a=0;for(var e=c.length;a<e;a++)if(c[a].h===b)return}else c=[],k[a]=c;c.push({h:b,j:d||b})};window.m=f})();
